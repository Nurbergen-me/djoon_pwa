(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59793feb"],{"24b7":function(t,s,e){t.exports=e.p+"img/no_photo.42679fe8.png"},f6af:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"basket_block"},[s("div",{staticClass:"basket_header_block"},[s("div",{staticClass:"basket_header_container"},[s("div",{staticClass:"basket_header_label"},[t._v(" "+t._s(t.$t("Basket"))+" ")]),s("div",{staticClass:"basket_header_basket_block"},[s("div",{staticClass:"basket_header_basket"},[s("div",{staticClass:"basket_header_basket_img"},[s("div",{staticClass:"basket_header_basket_number"},[t._v(t._s(t.countOfGoods))])]),s("div",{staticClass:"basket_header_basket_text"},[t._v(t._s(t.$t("Basket")))])])])])]),s("div",{staticClass:"basket_main_block"},[s("div",{staticClass:"basket_main_container"},[s("div",{staticClass:"basket_list_goods"},[s("div",{staticClass:"basket_coins"},[s("div",{staticClass:"basket_coins_text"},[t._v(t._s(t.$t("coin_count"))+":")]),s("div",{staticClass:"basket_coins_quantity"},[t._v(t._s(t.activeUserCoins))])]),s("div",{staticClass:"basket_contents"},[s("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.checkedCities,callback:function(s){t.checkedCities=s},expression:"checkedCities"}},t._l(t.basketData,(function(e){return s("div",{staticClass:"basket_contents_item"},[s("el-checkbox",{attrs:{label:e.id}},[t._v(t._s(e.id))]),s("img",{staticClass:"basket_contents_img",attrs:{src:t.backUrl+t.mainImage(e)},on:{error:t.setAltImg}}),s("div",{staticClass:"basket_contents_desc"},[s("div",{staticClass:"basket_contents_desc_title"},[t._v(t._s(e.translations[0].name))]),s("div",{staticClass:"basket_contents_desc_available",style:{color:-1!==t.errorIds.indexOf(e.id)?"red":""}},[t._v(t._s(t.$t("Available_items"))+": "+t._s(e.count))])]),s("div",{staticClass:"basket_contents_quantity"},[s("button",{staticClass:"basket_contents_quantity_minus",on:{click:function(s){return t.delGood(e.id)}}}),s("div",{staticClass:"basket_contents_quantity_number"},[t._v(t._s(e.pivot.count))]),s("button",{staticClass:"basket_contents_quantity_plus",attrs:{disabled:e.pivot.count>=e.count},on:{click:function(s){return t.addGood(e.id)}}})]),s("div",{staticClass:"basket_contents_price"},[t._v(t._s(e.price))])],1)})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.basketData.length,expression:"basketData.length === 0"}],staticClass:"basket_contents_empty"},[t._v(t._s(t.$t("basket_empty"))+" =(")])],1)]),s("div",{staticClass:"basket_order_container"},[s("div",{staticClass:"basket_order_selection"},[s("div",{staticClass:"basket_order_selection_detail"},[s("div",{staticClass:"basket_order_selection_title"},[t._v(t._s(t.$t("item_sel"))+":")]),s("div",{staticClass:"basket_order_selection_quantity"},[t._v(t._s(this.basketData.length)+" товара(-ов)")])]),s("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:!t.showModalPurchaseCompleted,expression:"!showModalPurchaseCompleted"}],staticClass:"basket_order_selection_checkbox",attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(s){t.checkAll=s},expression:"checkAll"}},[s("span",[t._v(t._s(t.$t("select_all")))])])],1),s("div",{staticClass:"basket_order_total"},[s("div",{staticClass:"basket_order_total_detail"},[s("div",{staticClass:"basket_order_total_title"},[t._v(t._s(t.$t("total")))]),s("div",{staticClass:"basket_order_total_quantity"},[t._v(t._s(t.priceOfGoods))])]),s("div",{staticClass:"basket_order_total_price"},[s("div",{staticClass:"basket_order_total_price_title"},[s("span",[t._v(t._s(t.$t("products"))+", "+t._s(t.countOfGoods)+" "+t._s(t.$t(t.count)))]),s("span",[t._v(t._s(t.priceOfGoods))])]),s("div",{staticClass:"basket_order_total_price_quantity"},[s("span",[t._v(t._s(t.$t("shipping")))]),s("span",[t._v(t._s(t.$t("free")))])])])]),s("div",{staticClass:"basket_order_delivery"},[t.showAddressInput?t._e():s("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip",value:t.$t("change_adress"),expression:"$t('change_adress')"}],staticClass:"basket_order_delivery_address",attrs:{href:"#"},on:{click:function(s){t.showAddressInput=!0}}},[t._v(" "+t._s(t.address?t.address:t.$t("enter_adress"))+" ")]),t.showAddressInput?s("el-input",{attrs:{type:"text"},nativeOn:{keyup:function(s){if(!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter"))return null;t.showAddressInput=!1}},model:{value:t.address,callback:function(s){t.address=s},expression:"address"}}):t._e()],1),s("div",{staticClass:"basket_order_date"},[t._v(" "+t._s(t.$t("date"))+": "),s("div",{staticClass:"basket_order_date_period"},[t._v("9-14июня")])]),s("div",{staticClass:"basket_order_offer"},[s("label",{staticClass:"basket_order_offer_checkbox",attrs:{for:"basket_offer"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.agreementWithTerms,expression:"agreementWithTerms"}],staticClass:"basket_offer_checkbox",attrs:{type:"checkbox",id:"basket_offer"},domProps:{checked:Array.isArray(t.agreementWithTerms)?t._i(t.agreementWithTerms,null)>-1:t.agreementWithTerms},on:{change:function(s){var e=t.agreementWithTerms,a=s.target,i=!!a.checked;if(Array.isArray(e)){var o=null,l=t._i(e,o);a.checked?l<0&&(t.agreementWithTerms=e.concat([o])):l>-1&&(t.agreementWithTerms=e.slice(0,l).concat(e.slice(l+1)))}else t.agreementWithTerms=i}}})]),s("div",{staticClass:"basket_order_offer_text"},[t._v(" "+t._s(t.$t("shop_agree"))+" ")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.priceOfGoods>this.userCoins,expression:"priceOfGoods > this.userCoins"}],staticClass:"basket_order_insufficient_funds"},[t._v(" "+t._s(t.$t("no_money"))+" ")]),s("button",{class:[t.disabledBuyBtn?t.disabledBtnClass:"",t.basicBtnClass],attrs:{disabled:t.disabledBuyBtn},on:{click:t.createOrder}},[t._v(" "+t._s(t.$t("buy_products"))+" ")])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showModal,expression:"showModal"}],staticClass:"basket_modal"},[s("div",{staticClass:"basket_modal_back"}),s("div",{staticClass:"basket_modal_front"},[s("div",{staticClass:"basket_modal_front_title"},[t._v(t._s(t.$t("no_money")))]),s("div",{staticClass:"basket_modal_front_icon"}),s("div",{staticClass:"basket_modal_close_form",on:{click:function(s){t.showModal=!1}}})])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showModalPurchaseCompleted,expression:"showModalPurchaseCompleted"}],staticClass:"basket_modal_purchase_completed"},[s("div",{staticClass:"basket_modal_block"},[s("div",{staticClass:"basket_modal_label"},[t._v(" "+t._s(t.$t("buy_succes"))+" ")]),s("div",{staticClass:"basket_modal_img"}),s("div",{staticClass:"basket_modal_my_orders"},[t._v(" "+t._s(t.$t("to_buy"))+" "),s("router-link",{staticClass:"basket_modal_my_orders",attrs:{to:"/my_orders"}},[t._v(" "+t._s(t.$t("My_orders")))])],1),s("div",{staticClass:"basket_modal_close_btn",on:{click:function(s){t.showModalPurchaseCompleted=!1}}})])])])])},i=[],o=(e("14d9"),e("2b0e")),l={name:"Basket",data(){var t;return{basketItemQuantity:8,deliveryNumber:0,basketNumber:10,basketData:[],backUrl:window.API_ROOT+"/images/goods/",userCoins:null,insufficientFunds:!1,isLoading:!1,showModal:!1,showModalPurchaseCompleted:!1,disabledBtnClass:"basket_order_btn_buy_disabled",basicBtnClass:"basket_order_btn_buy",agreementWithTerms:!1,checkedCities:[],isIndeterminate:!0,cities:this.countOfGoodsId,checkAll:!1,noPhoto:e("24b7"),errorIds:[],showAddressInput:!1,address:null!==(t=localStorage.getItem("address"))&&void 0!==t?t:""}},methods:{basketList(){if(localStorage.getItem("basket_id")){let t=localStorage.getItem("basket_id");this.isLoading=!0,this.$http.get(API_ROOT+`/api/shop/basket/goods?basket_id=${t} `).then(t=>{console.log(t),console.log(this.$i18n.locale),this.basketData=t.data.data}).catch(t=>{console.log(t),o["default"].toastr({message:"Error",description:t.message,type:"error"})}).finally(()=>this.isLoading=!1)}},addGood(t){this.isLoading=!0,console.log(this.isLoading),this.$http.post(API_ROOT+"/api/shop/basket/add",{basket_id:localStorage.getItem("basket_id"),good_id:t}).then(t=>{console.log(t),o["default"].toastr({message:"Success",description:"Product add to cart",type:"success"})}).then(t=>{this.basketList()}).catch(t=>{console.log(t)}).finally(()=>{this.isLoading=!1,console.log(this.isLoading)})},addCoins(){this.isLoading=!0,console.log(this.isLoading),this.$http.post(API_ROOT+"/api/user/change-coins",{count:6e5}).then(t=>{console.log(t),o["default"].toastr({message:"Success",description:"Product add to cart",type:"success"})}).then(t=>{this.basketList()}).catch(t=>{console.log(t)}).finally(()=>{this.isLoading=!1,console.log(this.isLoading)})},delGood(t){this.isLoading=!0,console.log(this.isLoading),this.$http.delete(API_ROOT+`/api/shop/basket/remove?basket_id=${localStorage.getItem("basket_id")}&good_id=${t}`).then(t=>{console.log(t),o["default"].toastr({message:"Success",description:"Product delete from cart",type:"success"})}).then(t=>{this.basketList()}).catch(t=>{console.log(t)}).finally(()=>{this.isLoading=!1,console.log(this.isLoading)})},createOrder(){const t=this;this.activeUserCoins>this.priceOfGoods?localStorage.getItem("basket_id")&&this.$http.post(API_ROOT+"/api/shop/order",{basket_id:localStorage.getItem("basket_id")}).then(()=>{this.$http.post(API_ROOT+"/api/shop/complete-order",{basket_id:localStorage.getItem("basket_id"),address:t.address}).then(()=>{this.showModalPurchaseCompleted=!0,localStorage.removeItem("basket_id"),localStorage.setItem("address",t.address);let s=localStorage.getItem("coins"),e=this.priceOfGoods;localStorage.setItem("coins",s-e+""),this.basketData=[]}).catch(t=>{console.error(t)})}).catch(t=>{var s;this.errorIds=null!==(s=t.body.error.ids)&&void 0!==s?s:[],console.log(t.body.error)}):this.showModal=!0},handleCheckedCitiesChange(t){let s=t.length;this.checkAll=s===this.cities.length,this.isIndeterminate=s>0&&s<this.cities.length},handleCheckAllChange(t){this.checkedCities=t?this.countOfGoodsId:[],this.isIndeterminate=!1},setAltImg(t){t.target.src=this.noPhoto},mainImage(t){for(let s=0;s<t.gallery.length;s++)if(1===t.gallery[s].is_main)return t.gallery[s].image}},mounted(){this.basketList()},computed:{countOfGoods(){let t=0;for(let s=0;s<this.basketData.length;s++)t+=this.basketData[s].pivot.count;return t},priceOfGoods(){let t=0;for(let s=0;s<this.basketData.length;s++)t+=this.basketData[s].pivot.count*this.basketData[s].price;return t},activeUserCoins(){return localStorage.getItem("coins")?this.userCoins=localStorage.getItem("coins"):this.userCoins=0},disabledBuyBtn(){return!(this.activeUserCoins>this.priceOfGoods&&this.agreementWithTerms&&this.address)},countOfGoodsId(){let t=[];for(let s=0;s<this.basketData.length;s++)t.push(this.basketData[s].id);return t}},watch:{basketList(){this.countOfGoods()},isLoading(){},agreementWithTerms(t){console.log(t)}}},d=l,c=e("2877"),r=Object(c["a"])(d,a,i,!1,null,"39442692",null);s["default"]=r.exports}}]);
//# sourceMappingURL=chunk-59793feb.4d748320.js.map